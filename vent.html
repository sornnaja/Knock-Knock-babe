<!doctype html>
<html lang="th">
<head>
  <link rel="stylesheet" href="theme.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à üíöüíú</title>
  <style>
   
    textarea, input{
  border: 1px solid rgba(255,255,255,.75);
  box-shadow: none;
}
textarea:focus, input:focus{
  outline: none;
  box-shadow: none;
  border-color: rgba(255,255,255,.75);
}

    textarea::placeholder{color:#00000080}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;align-items:center}
    button,a.btn{
      appearance:none;
      border:1px solid var(--line);
      background:#ffffff14;
      color:var(--text);
      padding:11px 14px;
      border-radius:14px;
      cursor:pointer;
      font-weight:900;
      text-decoration:none;
      display:inline-flex; gap:8px; align-items:center;
      transition:.18s transform,.18s background, .18s opacity;
    }
    button:hover,a.btn:hover{transform:translateY(-1px);background:#ffffff20}
    .primary{
      border:none;
      background: linear-gradient(135deg, var(--mint), var(--lav));
      color:#0b1220;
    }
    button:disabled{opacity:.55; cursor:not-allowed}
    .toast{color:var(--muted); font-size:13px; min-height:18px}
    .note{
      margin-top:10px;
      color:var(--muted);
      font-size:13px;
      line-height:1.6;
      border:1px dashed #00000055;
      border-radius:18px;
      padding:12px;
      background:#00000022;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà üíöüíú</h1>
      <p class="sub">
        ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å/‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢<br>
        <b>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</b> (‡πÑ‡∏°‡πà‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞) ‡πÄ‡∏ä‡∏¥‡∏ç‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà
      </p>

      <textarea
  id="msg"
  class="textBox"
  placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‚Ä¶ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£ ‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ üíå"
></textarea>
      <div class="row">
        <button id="send" type="button" class="primary">‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏ï‡πà‡∏≠ ‚ûú</button>
        <div id="status" class="toast"></div>
        <a class="btn" href="index.html">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡∏°</a>
      </div>

      <div class="note">
        ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ô‡πá‡∏ï‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏ï‡πà‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏∞‡∏û‡∏≤‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÉ‡∏´‡πâ
      </div>
    </div>
  </div>

  <script>
    // ‚úÖ ‡πÉ‡∏ä‡πâ URL ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ /exec)
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwDohC6zPbHXXv6E-_kJJCAEij8ngY_f4hkJnFwScNl6AEqPibTQqUh9CCzvVliHJk0bQ/exec";
    const NEXT_PAGE  = "q1.html";

    const ta = document.getElementById("msg");
    const sendBtn = document.getElementById("send");
    const statusEl = document.getElementById("status");

    function setStatus(t){ if(statusEl) statusEl.textContent = t; }

    function timeoutFetch(ms){
      const controller = new AbortController();
      const id = setTimeout(()=>controller.abort(), ms);
      return { signal: controller.signal, stop: ()=>clearTimeout(id) };
    }

    async function sendToSheet(text){
      const payload = {
        name: "Cream",
        message: text,
        page: "vent.html",
        ts: Date.now()
      };

      const t = timeoutFetch(7000);
      try{
        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload),
          signal: t.signal
        });

        // Apps Script ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà JSON ‡∏Å‡πá‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ ok ‡∏ñ‡πâ‡∏≤ status 200
        let data = null;
        try { data = await res.json(); } catch {}

        if(res.ok && (!data || data.ok !== false)) return true;
        return false;
      } finally {
        t.stop();
      }
    }

    sendBtn.addEventListener("click", async ()=>{
      const text = (ta.value || "").trim();
      if(!text){
        setStatus("‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≤ üôÇ");
        ta.focus();
        return;
      }

      sendBtn.disabled = true;
      setStatus("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...");

      let ok = false;
      try{
        ok = await sendToSheet(text);
      }catch(e){
        ok = false;
      }

      if(ok){
        setStatus("‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß ‚úì ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ...");
        setTimeout(()=>location.href = NEXT_PAGE, 350);
      }else{
        setStatus("‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏ä‡πá‡∏Å‡πÄ‡∏ô‡πá‡∏ï/‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Deploy) ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡πÑ‡∏õ‡∏ï‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ô‡∏∞");
        setTimeout(()=>location.href = NEXT_PAGE, 900);
      }
    });
  </script>
</body>
</html>
